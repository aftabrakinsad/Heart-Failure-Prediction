# -*- coding: utf-8 -*-
"""DT.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1W6cjGgoUhg6LGiwVY-WaygXkvfE_mlQA
"""

import time
import numpy as np
import pandas as pd
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, roc_auc_score

X_train = pd.read_csv('/content/X_train_final.csv')
X_test = pd.read_csv('/content/X_test_processed.csv')
y_train = pd.read_csv('/content/y_train_final.csv').values.ravel()
y_test = pd.read_csv('/content/y_test_processed.csv').values.ravel()

best_model = DecisionTreeClassifier(
    max_depth= 9,
    min_samples_split= 9,
    min_samples_leaf= 2,
    criterion= 'gini'
)
best_model.fit(X_train, y_train)

y_train_pred = best_model.predict(X_train)
y_train_prob = best_model.predict_proba(X_train)[:, 1]

train_accuracy = accuracy_score(y_train, y_train_pred)
train_precision = precision_score(y_train, y_train_pred)
train_recall = recall_score(y_train, y_train_pred)
train_f1 = f1_score(y_train, y_train_pred)
train_auc = roc_auc_score(y_train, y_train_prob)
train_loss = 1 - train_accuracy #

print("\nTraining Set Results:")
print(f"Accuracy: {train_accuracy * 100:.2f}%")
print(f"Precision: {train_precision * 100:.2f}%")
print(f"Recall: {train_recall * 100:.2f}%")
print(f"F1 Score: {train_f1 * 100:.2f}%")
print(f"AUC: {train_auc * 100:.2f}%")
print(f"Loss: {train_loss * 100:.2f}%")

print("\n--- Model Inference Time (Test Set) ---")
start_time_warmup = time.time()
_ = best_model.predict(X_test)
end_time_warmup = time.time()
print(f"Warm-up prediction time for {X_test.shape[0]} samples: {(end_time_warmup - start_time_warmup):.4f} seconds")

start_time = time.time()
y_test_pred = best_model.predict(X_test)
end_time = time.time()
inference_time = end_time - start_time

y_test_prob = best_model.predict_proba(X_test)[:, 1]

test_accuracy = accuracy_score(y_test, y_test_pred)
test_precision = precision_score(y_test, y_test_pred)
test_recall = recall_score(y_test, y_test_pred)
test_f1 = f1_score(y_test, y_test_pred)
test_auc = roc_auc_score(y_test, y_test_prob)
test_loss = 1 - test_accuracy

print("\nTest Set Results:")
print(f"Accuracy: {test_accuracy * 100:.2f}%")
print(f"Precision: {test_precision * 100:.2f}%")
print(f"Recall: {test_recall * 100:.2f}%")
print(f"F1 Score: {test_f1 * 100:.2f}%")
print(f"AUC: {test_auc * 100:.2f}%")
print(f"Loss: {test_loss:.4f}")
print(f"Model Inference Time: {inference_time:.4f} seconds")
print(f"Average inference time per sample: {(inference_time / X_test.shape[0] * 1000):.4f} ms/sample")